<?xml version="1.0" encoding="UTF-8"?>
<FindBugsFilter>
    <!-- Suppress false positives for Spring Framework patterns -->
    
    <!-- Spring Security filters are designed to be mutable and managed by Spring -->
    <Match>
        <Class name="com.novareport.payments_xmr_service.config.SecurityConfig"/>
        <Bug pattern="EI_EXPOSE_REP2"/>
    </Match>
    
    <!-- RestTemplate is a Spring-managed bean, exposure is intentional -->
    <Match>
        <Class name="com.novareport.payments_xmr_service.service.SubscriptionsClient"/>
        <Bug pattern="EI_EXPOSE_REP2"/>
    </Match>
    
    <!-- Spring Controllers are endpoints by design, not a security issue -->
    <Match>
        <Bug pattern="SPRING_ENDPOINT"/>
    </Match>
    
    <!-- JwtService constructor validation is intentional, not a security issue -->
    <Match>
        <Class name="com.novareport.payments_xmr_service.auth.JwtService"/>
        <Bug pattern="CT_CONSTRUCTOR_THROW"/>
    </Match>
    
    <!-- Locale.ROOT is used for toLowerCase, Unicode handling is correct -->
    <Match>
        <Class name="com.novareport.payments_xmr_service.service.PaymentService"/>
        <Bug pattern="IMPROPER_UNICODE"/>
    </Match>
    
    <!-- Logging uses LogSanitizer; CRLF injection warnings are false positives for these classes -->
    <Match>
        <Class name="com.novareport.payments_xmr_service.exception.GlobalExceptionHandler"/>
        <Bug pattern="CRLF_INJECTION_LOGS"/>
    </Match>
    <Match>
        <Class name="com.novareport.payments_xmr_service.service.PaymentService"/>
        <Bug pattern="CRLF_INJECTION_LOGS"/>
    </Match>
    <Match>
        <Class name="com.novareport.payments_xmr_service.service.PaymentMonitorService"/>
        <Bug pattern="CRLF_INJECTION_LOGS"/>
    </Match>
    <Match>
        <Class name="com.novareport.payments_xmr_service.service.SubscriptionActivationService"/>
        <Bug pattern="CRLF_INJECTION_LOGS"/>
    </Match>
    <Match>
        <Class name="com.novareport.payments_xmr_service.service.SubscriptionsClient"/>
        <Bug pattern="CRLF_INJECTION_LOGS"/>
    </Match>
    <Match>
        <Class name="com.novareport.payments_xmr_service.service.MoneroWalletClient"/>
        <Bug pattern="CRLF_INJECTION_LOGS"/>
    </Match>

    <!-- Micrometer MeterRegistry is injected by Spring; EI_EXPOSE_REP2 is not a real leak here -->
    <Match>
        <Class name="com.novareport.payments_xmr_service.service.PaymentService"/>
        <Bug pattern="EI_EXPOSE_REP2"/>
    </Match>
    <Match>
        <Class name="com.novareport.payments_xmr_service.service.MoneroWalletClient"/>
        <Bug pattern="EI_EXPOSE_REP2"/>
    </Match>

    <!-- MoneroWalletClient only talks to internal monero-wallet-rpc; SSRF warning is overly strict -->
    <Match>
        <Class name="com.novareport.payments_xmr_service.service.MoneroWalletClient"/>
        <Bug pattern="URLCONNECTION_SSRF_FD"/>
    </Match>

</FindBugsFilter>
